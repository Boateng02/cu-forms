{% extends "layout.html" %}

{% block head %}

<link rel="stylesheet" href="../static/css/form.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">


<meta name="keywords" content="forms, satc, tracer forms, Central University, Alumni, Alumnus, forms.central, central forms, cuc, cu">
<link rel="icon" href="../static/img/cufavicon.png" type="image/x-icon">
<meta property="og:image" content="../static/img/ogLogo.png">
<meta property="og:image:width" content="600">
<meta property="og:image:height" content="400">

{% endblock %}

{% block body %}
<div class="container">
    
    <br/>
    <h6>This questionnaire is designed to enable us assess the overall performance of each lecturer. Your candid and objective appraisal will go a long way in enhancing the quality of the programme.</h6>
    <br/>

    <form action="" method="post">
        {{form.hidden_tag()}}

        <h4 style="font-weight:bold;">Section A</h4>
        <h6 class="text-muted">This information is to be provided by the officer in charge</h6>
        <br/>

        <div class="mb-3">
            <label for="" class="form-label">{{form.name.label}}</label>
            {{form.name (id="lecturer" ,class="answerCard", placeholder="Enter The Lecturers Name") }}
            <ul id="autocomplete-results"></ul>
        </div>

        

        <div class="mb-3">
            <label for="" class="form-label">{{form.part.label}}</label>
            {{form.part (class="answerCard") }}
        </div>

        <div class="mb-3">
            <label for="" class="form-label">{{form.department.label}}</label>
            {{form.department (id="department", class="answerCard", placeholder="Enter The Department") }}
        </div>

        <div class="mb-3">
            <label for="" class="form-label">{{form.course.label}}</label>
            {{form.course (id="courses", class="answerCard", placeholder="Enter The Course Name") }}
        </div>

        <div class="mb-3">
            <label for="" class="form-label">{{form.semester.label}}</label>
            {{form.semester(class="answerCard", placeholder="Enter The Semester") }}
        </div>

        <div class="mb-3">
            <label for="" class="form-label">{{form.session.label}}</label>
            {{form.session (id="stream", class="answerCard") }}
        </div>

        <div class="mb-3">
            <label for="" class="form-label">{{form.classSize.label}}</label>
            {{form.classSize (id="noOfStudents", class="answerCard", placeholder="Enter The Class Size") }}
        </div>


        <br/>

        <h4 style="font-weight:bold;">Section B</h4>
        <h6 class="text-muted">Please assess the lecturer's performance using the key provided below by ticking the box you consider appropriate</h6>
        <br/>

        <!-- <h4 class="text-muted" style="text-align: center;">SECTION B</h4>
        <h6 class="text-muted" style="text-align: center;">Please asses the lecturer's performance using the key provided below by ticking the box you consider appropriate</h6> -->

        <h6 class="text-muted" style="text-align: center;">Course Content</h6>
        <div class="mb-3">
            <label for="" class="form-label">{{form.one.label}}</label>
            {{form.one (class="answerCard") }}
        </div>

        <div class="mb-3">
            <label for="" class="form-label">{{form.two.label}}</label>
            {{form.two (class="answerCard") }}
        </div>

        <h6 class="text-muted" style="text-align: center;">Class Attendance</h6>

        <div class="mb-3">
            <label for="" class="form-label">{{form.three.label}}</label>
            {{form.three (class="answerCard") }}
        </div>

        <div class="mb-3">
            <label for="" class="form-label">{{form.four.label}}</label>
            {{form.four (class="answerCard") }}
        </div>

        <h6 class="text-muted" style="text-align: center;">Mode of Delivery</h6>


        <div class="mb-3">
            <label for="" class="form-label">{{form.five.label}}</label>
            {{form.five (class="answerCard") }}
        </div>

        <div class="mb-3">
            <label for="" class="form-label">{{form.six.label}}</label>
            {{form.six (class="answerCard") }}
        </div>

        <div class="mb-3">
            <label for="" class="form-label">{{form.seven.label}}</label>
            {{form.seven (class="answerCard") }}
        </div>

        <div class="mb-3">
            <label for="" class="form-label">{{form.eight.label}}</label>
            {{form.eight (class="answerCard") }}
        </div>

        <div class="mb-3">
            <label for="" class="form-label">{{form.nine.label}}</label>
            {{form.nine (class="answerCard") }}
        </div>

        <div class="mb-3">
            <label for="" class="form-label">{{form.ten.label}}</label>
            {{form.ten (class="answerCard") }}
        </div>

        <h6 class="text-muted" style="text-align: center;">Assessment</h6>


        <div class="mb-3">
            <label for="" class="form-label">{{form.eleven.label}}</label>
            {{form.eleven (class="answerCard") }}
        </div>

        <div class="mb-3">
            <label for="" class="form-label">{{form.twelve.label}}</label>
            {{form.twelve (class="answerCard") }}
        </div>

        <div class="mb-3">
            <label for="" class="form-label">{{form.thirteen.label}}</label>
            {{form.thirteen (class="answerCard") }}
        </div>

        <h6 class="text-muted" style="text-align: center;">General Assessment Of Lecturer</h6>

        <div class="mb-3">
            <label for="" class="form-label">{{form.fourteen.label}}</label>
            {{form.fourteen (class="answerCard") }}
        </div>


        <h4 style="font-weight:bold;">Section C</h4>
        <h6 class="text-muted">Assessment of Course. Please provide statementes in the spaces provided below:</h6>
        <br/>
        
        <div class="mb-3">
            <label for="" class="form-label">{{form.fifteen.label}}</label>
            {{form.fifteen (class="answerCard") }}
        </div>


        <div class="mb-3">
            <label for="" class="form-label">{{form.sixteen.label}}</label>
            {{form.sixteen (class="answerCard") }}
        </div>

        <div class="mb-3">
            <label for="" class="form-label">{{form.seventeen.label}}</label>
            {{form.seventeen (class="answerCard") }}
        </div>

        <div class="mb-3">
            <label for="" class="form-label">{{form.eighteen.label}}</label>
            {{form.eighteen (class="answerCard") }}
        </div>
<!-- 
        <div class="mb-3">
            <label for="" class="form-label">{{form.nineteen.label}}</label>
            {{form.nineteen (class="answerCard") }}
        </div> -->
<!-- <div style="margin: auto; text-align:center; margin-bottom: 2vh;">
    {{form.submit (class="button", style="width:50%;")}}
</div> -->
<div style="margin: auto; text-align:center; margin-bottom: 2vh;">
    <!-- {{form.submit (class="button", style="width:50%;")}} -->
    <a href='{{url_for("allSurveys")}}'></a>
    <button class="button" style="width: 50%;">Submit</button>
</div>
      
    </form>
    
</div>

<!-- <script>

    // TODO: GET VALUES FROM THE PYTHON SCRIPT INSTEAD!

    fetch('/alllecturers').then(function(response) {
        response.json().then(function(data) {
            console.log("-----------data-------------")
            console.log(data.lecturers)
            var alllecturers = data.lecturers
        })
    });
    // const alllecturers = lectures
</script> -->

<script>
const inputElement = document.getElementById('lecturer');
const resultsElement = document.getElementById('autocomplete-results');
let allOptions = []; // The array to store all the options from the API

fetch('/alllecturers').then(function(response) {
        response.json().then(function(data) {
            console.log("-----------data-------------")
            console.log(data.lecturers)
            allOptions = data.lecturers
        })
    });

// Simulating API response with an array of options
// Replace this with your actual API call to populate 'allOptions'
// allOptions = ['apple', 'banana', 'cherry', 'orange', 'grape', 'kiwi', 'mango'];

inputElement.addEventListener('input', onInputChange);

function onInputChange() {
  const query = inputElement.value.trim();
  const filteredOptions = allOptions.filter(option =>
    option.toLowerCase().includes(query.toLowerCase())
  );
  displaySuggestions(filteredOptions);
}

function displaySuggestions(suggestions) {
  resultsElement.innerHTML = '';
  if (suggestions.length === 0) {
    resultsElement.style.display = 'none';
    return;
  }

  suggestions.forEach(suggestion => {
    const li = document.createElement('li');
    li.textContent = suggestion;
    li.addEventListener('click', () => {
      inputElement.value = suggestion;
      resultsElement.style.display = 'none';
      console.log("------------")
      console.log(suggestion)
      localStorage.setItem("lecturerName", suggestion)
      findLecturer(suggestion)
    });
    resultsElement.appendChild(li);


  });

  resultsElement.style.display = 'block';
}

</script>

<script>
    var state_select = document.getElementById("lecturer");
    var city_select = document.getElementById("courses");
    var stream_select = document.getElementById("stream");
    var department_select = document.getElementById("department");
    var noOfStudents_select = document.getElementById("noOfStudents");

    // state_select.onchange = function(){
    function findLecturer(){
        console.log("Lecturer changed to " + localStorage.getItem("lecturerName"))
        state = state_select.value;
        fetch('/courses/' + state).then(function(response) {
            response.json().then(function(data) {
                console.log (data)
                var optionHTML = '';
                var departmentHTML = '';
                var streamHTML = '';
                var noOfStudentsHTML = '';
                // return one object with multiple arrays?

                // CourseTitle
                for (var course of data.courses) {
                    console.log("course")
                    console.log(course)
                    optionHTML += '<option value="' + course + '">' + course + '</option>';
                }
                // ClassSize
                // Department
                for (var department of data.departments) {
                    console.log("classSize")
                    console.log(department)
                    departmentHTML += '<option value="' +department + '">' + department + '</option>';
                }
                
                for (var stream of data.sessions) {
                    streamHTML += '<option value="' + stream + '">' + stream + '</option>';
                }
                
                for (var students of data.totalStudents) {
                    // streamHTML += '<option value="' + stream + '">' + stream + '</option>';
                    noOfStudentsHTML += '<option value="' + students + '">' + students + '</option>';
                }
                
                
                city_select.innerHTML = optionHTML;
                stream_select.innerHTML = streamHTML;
                department_select.innerHTML = departmentHTML;
                noOfStudents_select.innerHTML = noOfStudentsHTML;
            })
        });
    }

</script>
{% endblock %}